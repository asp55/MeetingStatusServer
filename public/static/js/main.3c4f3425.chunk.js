(this["webpackJsonproom-monitor"]=this["webpackJsonproom-monitor"]||[]).push([[0],{19:function(e,n,t){},20:function(e,n,t){},21:function(e,n,t){"use strict";t.r(n);var o,i=t(0),c=t(1),s=t.n(c),r=t(7),a=t.n(r),l=(t(19),t(13)),u=t(4),d=(t(20),t(8)),b=t(9),f=t(10),h=t(11),p=t(12),j=function(e){Object(f.a)(t,e);var n=Object(h.a)(t);function t(e){var o,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return Object(d.a)(this,t),(o=n.call(this))._url=e,o._protocols=[],o._persist=!0,o.onclose=function(){},o.onerror=function(){},o.onmessage=function(){},o.onopen=function(){},i&&o.start(),o}return Object(b.a)(t,[{key:"start",value:function(){var e=this;this._persist=!0,this._connection=new WebSocket(this._url,this._protocols),"undefined"!==typeof this._binaryType&&(this._connection.binaryType=this._binaryType);this._connection.addEventListener("open",(function(n){var t=n.type,o=n.bubbles,i=n.cancelable,c=n.composed,s=new Event(t,{bubbles:o,cancelable:i,composed:c});e.dispatchEvent(s),e.onopen(s)})),this._connection.addEventListener("close",(function(n){e._persist&&(e._connection=null,setTimeout((function(){e._persist&&e.start()}),500));var t=n.type,o=n.bubbles,i=n.cancelable,c=n.composed,s=n.wasClean,r=n.code,a=n.reason,l=new CloseEvent(t,{bubbles:o,cancelable:i,composed:c,wasClean:s,code:r,reason:a});e.dispatchEvent(l),e.onclose(l)})),this._connection.addEventListener("message",(function(n){var t=n.type,o=n.bubbles,i=n.cancelable,c=n.composed,s=n.data,r=n.origin,a=n.lastEventId,l=n.source,u=n.ports,d=new MessageEvent(t,{bubbles:o,cancelable:i,composed:c,data:s,origin:r,lastEventId:a,source:l,ports:u});e.dispatchEvent(d),e.onmessage(d)})),this._connection.addEventListener("error",(function(n){var t=n.type,o=n.bubbles,i=n.cancelable,c=n.composed,s=new Event(t,{bubbles:o,cancelable:i,composed:c});e.dispatchEvent(s),e.onerror(s)}))}},{key:"stop",value:function(){this._persist=!1,this._connection.close()}},{key:"send",value:function(e){try{this._connection.send(e)}catch(n){throw n}}},{key:"binaryType",get:function(){return this._connection.binaryType},set:function(e){this._binaryType=e,this._connection.binaryType=e}},{key:"bufferedAmount",get:function(){return this._connection.bufferedAmount}},{key:"extensions",get:function(){return this._connection.extensions}},{key:"protocol",get:function(){return this._connection.protocol}},{key:"readyState",get:function(){return 3===this._connection.readyState&&this._persist?4:this._connection.readyState}},{key:"url",get:function(){return this._connection.url}}]),t}(Object(p.a)(EventTarget)),m=window.location;o="https:"===m.protocol?"wss:":"ws:";var v=new j(o+="//"+m.host,[],!1);function y(e){return Object(i.jsx)("div",{className:e.className,children:Object(i.jsx)("svg",{viewBox:"0 0 1168 476",preserveAspectRatio:"xMidYMid meet",children:Object(i.jsx)("text",{x:"584",y:"238",fill:"white",fontFamily:"Barlow-SemiBold, Barlow",fontSize:"180",fontWeight:"600",textAnchor:"middle",children:Object(i.jsx)("tspan",{dy:".35em",id:"statusLabel",children:e.children})})})})}function O(e){var n,t=e.info,o=t.name,c=t.status,s=!1;return"string"===typeof c?n=Object(i.jsx)(y,{className:"status offline",children:c}):c.inMeeting?(s=!0,n=Object(i.jsx)(y,{className:"status busy",children:"MEETING"})):n=Object(i.jsx)(y,{className:"status free",children:"FREE"}),Object(i.jsxs)("div",{onClick:e.onClick,className:[e.className,s?" busy":""].join(" ").trim(),children:[Object(i.jsx)("h1",{children:o}),n]})}var g=function(){var e=Object(c.useState)(""),n=Object(u.a)(e,2),t=n[0],o=n[1],s=Object(c.useState)(!1),r=Object(u.a)(s,2),a=r[0],d=r[1],b=Object(c.useState)("initializing"),f=Object(u.a)(b,2),h=f[0],p=f[1],j=Object(c.useReducer)((function(e,n){switch(n.action){case"initialize":return 1===n.rooms.length&&o(n.rooms[0]),{keys:n.rooms,info:n.roomInfo};case"update":return e.info[n.room]=n.roomInfo,Object(l.a)({},e);default:return console.log("Unsupported Action: ".concat(n.action)),e}}),{keys:[],info:{}}),m=Object(u.a)(j,2),g=m[0],_=m[1],E=function(e){console.log("WebSocket is open now."),p("initializing"),v.send(JSON.stringify({action:"identify",type:"monitor"}))},x=function(e){console.log("WebSocket error: ".concat(e))},k=function(e){console.log("WebSocket is closed now. Reconnecting in 0.5s"),p("offline")},w=function(e){var n=JSON.parse(e.data);console.log("Message received: ",{parsed:n,raw:e.data}),p("online"),_(n)};if(Object(c.useEffect)((function(){return v.addEventListener("open",E),v.addEventListener("error",x),v.addEventListener("message",w),v.addEventListener("close",k),v.start(),function(){v.removeEventListener("open",E),v.removeEventListener("error",x),v.removeEventListener("message",w),v.removeEventListener("close",k),v.stop()}}),[]),"initializing"===h)return Object(i.jsx)("div",{className:"MonitorPanel",children:Object(i.jsx)(y,{children:"Initializing..."})});if("offline"===h)return Object(i.jsx)("div",{className:"MonitorPanel",children:Object(i.jsx)(y,{children:"Offline"})});var N="";(a||""===t)&&(N=Object(i.jsx)("div",{className:"Picker",children:g.keys.map((function(e){return Object(i.jsx)(O,{onClick:function(){o(e),d(!1)},info:g.info[e],className:"room"},"chip-".concat(e))}))}));var S="";return""!==t&&t in g.info&&(S=Object(i.jsx)(O,{info:g.info[t],className:"Monitor"})),Object(i.jsxs)("div",{className:"MonitorPanel",children:[g.keys.length>1?Object(i.jsx)("button",{onClick:function(){return d(!a)},children:"Rooms"}):"",N,S]})};a.a.render(Object(i.jsx)(s.a.StrictMode,{children:Object(i.jsx)(g,{})}),document.getElementById("root"))}},[[21,1,2]]]);
//# sourceMappingURL=main.3c4f3425.chunk.js.map